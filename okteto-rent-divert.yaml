# Okteto Divert Configuration - Rent Service
# Driver: nginx (uses Nginx ingress + Linkerd for routing)
# To use Istio instead, change driver to "istio" below

icon: https://apps.okteto.com/movies/icon.png

build:
  rent:
    context: rent

deploy:
  commands:
    - helm upgrade --install movies-rent rent/chart --set image=${OKTETO_BUILD_RENT_IMAGE}
  divert:
    driver: nginx
    namespace: ${SHARED_NAMESPACE:-staging}

dev:
  rent:
    image: maven:3-openjdk-11
    command: mvn spring-boot:run
    workdir: /app
    sync:
      - rent:/app
    forward:
      - 8080:8080
    environment:
      KAFKA_BOOTSTRAP_SERVERS: kafka:9092

# Okteto Divert Configuration - Catalog Service
# Driver: nginx (uses Nginx ingress + Linkerd for routing)
# To use Istio instead, change driver to "istio" below

icon: https://apps.okteto.com/movies/icon.png

build:
  catalog:
    context: catalog

deploy:
  commands:
    - helm upgrade --install movies-catalog catalog/chart --set image=${OKTETO_BUILD_CATALOG_IMAGE}
  divert:
    driver: nginx
    namespace: ${SHARED_NAMESPACE:-staging}

dev:
  catalog:
    image: node:14
    command: yarn start
    workdir: /src
    sync:
      - catalog:/src
    forward:
      - 8080:8080
    environment:
      MONGODB_HOST: mongodb
